namespace Conceal

module SlidesLoader =
  let image = """<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->

<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   id="svg2816"
   version="1.1"
   inkscape:version="0.47 r22583"
   width="100"
   height="100"
   sodipodi:docname="at.svg">
  <metadata
     id="metadata2822">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <defs
     id="defs2820">
    <inkscape:perspective
       sodipodi:type="inkscape:persp3d"
       inkscape:vp_x="0 : 0.5 : 1"
       inkscape:vp_y="0 : 1000 : 0"
       inkscape:vp_z="1 : 0.5 : 1"
       inkscape:persp3d-origin="0.5 : 0.33333333 : 1"
       id="perspective2824" />
    <inkscape:perspective
       id="perspective2855"
       inkscape:persp3d-origin="0.5 : 0.33333333 : 1"
       inkscape:vp_z="1 : 0.5 : 1"
       inkscape:vp_y="0 : 1000 : 0"
       inkscape:vp_x="0 : 0.5 : 1"
       sodipodi:type="inkscape:persp3d" />
  </defs>
  <sodipodi:namedview
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1"
     objecttolerance="10"
     gridtolerance="10"
     guidetolerance="10"
     inkscape:pageopacity="0"
     inkscape:pageshadow="2"
     inkscape:window-width="1680"
     inkscape:window-height="988"
     id="namedview2818"
     showgrid="false"
     inkscape:zoom="4.72"
     inkscape:cx="28.445008"
     inkscape:cy="48.558123"
     inkscape:window-x="-8"
     inkscape:window-y="-8"
     inkscape:window-maximized="0"
     inkscape:current-layer="svg2816" />
  <path
     style="fill:#000000"
     d=""
     id="path2828" />
  <path
     style="fill:#6b8fff;fill-opacity:1;stroke:none"
     d="m 75.582609,92.785014 c 0.03326,-0.0315 1.587347,-0.76688 3.453533,-1.63421 1.976379,-0.91854 4.030843,-1.99616 4.920587,-2.58096 1.760361,-1.15705 3.307573,-2.54395 3.65517,-3.27646 0.299665,-0.63149 0.30888,-1.46879 0.02227,-2.02304 -0.524854,-1.01496 -3.08481,-2.8146 -5.480498,-3.85279 -1.983683,-0.85963 -3.277245,-1.13864 -5.312104,-1.14574 -3.766777,-0.0131 -7.041014,1.22291 -14.381833,5.42928 -3.216652,1.84318 -7.363965,3.89882 -8.860305,4.39167 -0.670976,0.22099 -1.783321,0.4996 -2.471878,0.61911 -3.966138,0.68843 -11.053308,0.96801 -14.210551,0.56059 -8.161213,-1.05313 -15.3445,-4.05518 -21.947276,-9.17224 -3.329532,-2.58034 -7.7455614,-7.08942 -9.5058354,-9.70615 C 1.9946424,65.236894 -0.17257249,54.790552 0.36272751,45.805613 1.0269105,34.65737 4.2484456,25.122193 9.8529886,17.716096 14.325021,11.806552 20.890892,5.9492037 25.05625,4.1534207 c 3.465966,-1.49426 7.764826,-2.200884 14.264502,-2.344723 7.14943,-0.158218 13.308925,0.641664 17.558292,2.280148 7.966278,3.071661 15.855735,10.9585673 18.502081,18.4960993 1.539951,4.386208 2.32882,11.214591 1.843231,15.954846 -0.916382,8.945605 -3.819997,16.463692 -10.655555,21.667653 -3.372936,2.567841 -5.672674,3.750779 -10.70074,4.7649 -3.499371,0.705795 -6.547299,0.67115 -9.125386,0.47098 -5.358879,-0.41607 -9.697764,-1.81879 -13.57757,-4.38948 -1.706916,-1.13097 -4.25123,-3.61809 -5.348064,-5.227839 -3.262311,-4.787884 -4.221898,-10.475334 -2.787066,-16.518876 0.971994,-4.094064 2.735267,-7.017603 5.488155,-9.099466 2.975161,-2.249956 6.897758,-3.329929 10.818287,-2.9785 3.767013,0.337666 6.583961,1.387433 8.545032,3.184398 1.644963,1.507311 2.23204,2.952051 1.866912,4.594295 -0.558181,2.510537 -2.373515,4.147933 -4.790417,4.320863 -1.372825,0.09822 -2.242033,-0.115481 -5.022284,-1.234792 -4.421784,-1.78018 -6.010406,-1.654295 -8.20834,0.650434 -1.043722,1.094436 -1.511219,2.090309 -1.849658,3.940184 -0.656028,3.585787 0.66678,7.601458 3.49365,10.605738 3.079784,3.273065 7.189428,5.063671 12.362958,5.386641 7.931716,0.49516 15.71115,-3.123222 19.690651,-9.158547 2.595625,-3.93653 3.837268,-8.394224 3.829941,-13.750085 -0.01248,-9.12616 -3.999735,-17.194534 -11.117112,-22.495956 -2.541555,-1.893094 -5.204941,-3.074452 -8.3798,-3.7169023 -2.586694,-0.523431 -3.775727,-0.624198 -8.324182,-0.70545 -12.46941,-0.222749 -17.050487,1.5984933 -24.474569,9.7300573 -6.122386,6.70582 -8.077536,10.196887 -9.5893174,17.122441 -1.774986,8.131317 -2.122891,14.689488 -1.060482,19.990641 0.638207,3.184491 2.5852514,8.137401 4.2402504,10.786371 2.351186,3.76329 6.809027,7.8802 12.194195,11.26158 6.603708,4.14651 13.300085,5.98335 20.125772,5.52055 4.082832,-0.27683 5.039469,-0.6472 14.518997,-5.62122 6.636097,-3.48204 7.508425,-3.90764 9.512983,-4.64124 2.296392,-0.8404 3.552269,-1.0363 6.666579,-1.03987 2.822527,-0.003 4.327388,0.15449 6.516768,0.683 5.19005,1.25286 12.270303,5.27096 16.186693,9.18607 1.47848,1.47801 1.815253,2.29504 1.66285,4.03432 -0.23826,2.71922 -0.82578,3.30142 -4.38716,4.34738 -5.021605,1.47482 -9.727306,2.29279 -13.911816,2.41822 -1.318334,0.0395 -3.233163,0.10383 -4.255173,0.14293 -1.022012,0.0391 -1.83099,0.0453 -1.797729,0.0138 l 0,0 z"
     id="path2869"
     sodipodi:nodetypes="cssssssssssssssssssssssssssssssssssssssssssssssssssssssscc" />
</svg>"""

  let load (style: Style) (path: string) =
    // TODO : impl
    Some [|
      Page.Create(
        TitlePage,
        [PageContent.CreateText(Text.Create(TextElement.Create("Title", style.TextColor)))],
        [])
      Page.Create(
        ContentPage,
        [PageContent.CreateText(Text.Create(TextElement.Create("Header", style.TextColor)))],
        [PageContent.CreateSvg(image)
         PageContent.CreateList([
           [PageContent.CreateText(Text.Create(TextElement.Create("aaa", style.TextColor)))]
           [PageContent.CreateText(Text.Create(TextElement.Create("bbb", style.TextColor)))]
           [PageContent.CreateText(Text.Create(TextElement.Create("ccc", style.TextColor)))]
         ])])
      Page.Create(
        ContentPage,
        [PageContent.CreateText(Text.Create(TextElement.Create("Header", style.TextColor)))],
        [PageContent.CreateText(Text.Create(TextElement.Create("sample body", style.TextColor)))])
      Page.Create(
        ContentPage,
        [PageContent.CreateText(Text.Create(TextElement.Create("Header", style.TextColor)))],
        [PageContent.CreateList([
           [PageContent.CreateText(Text.Create(TextElement.Create("item1", style.TextColor)))]
           [PageContent.CreateText(Text.Create(TextElement.Create("item2", style.TextColor)))
            PageContent.CreateList([
              [PageContent.CreateText(Text.Create(TextElement.Create("sub-item1", style.TextColor)))]
              [PageContent.CreateText(Text.Create(TextElement.Create("sub-item2", style.TextColor)))]
            ])]
           [PageContent.CreateText(Text.Create(TextElement.Create("item3", style.TextColor)))]
         ])])
    |]
